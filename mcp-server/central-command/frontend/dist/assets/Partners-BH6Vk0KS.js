import{r as l,j as e,G as x,B as E,S as I}from"./index-DEFEL2Dr.js";const A=()=>localStorage.getItem("auth_token"),K={auth:"text-health-healthy bg-green-50",admin:"text-ios-purple bg-purple-50",site:"text-ios-blue bg-blue-50",provision:"text-ios-blue bg-blue-50",credential:"text-ios-orange bg-orange-50",asset:"text-ios-teal bg-teal-50",discovery:"text-ios-teal bg-teal-50",learning:"text-ios-indigo bg-indigo-50"},Q=s=>!s.success||s.event_type.includes("failed")||s.event_type.includes("rejected")?"text-health-critical bg-red-50":K[s.event_category]||"text-label-secondary bg-gray-100",Y=s=>s.replace(/_/g," ").replace(/\b\w/g,y=>y.toUpperCase()),X=s=>new Date(s).toLocaleString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});function U(s){return new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}const Z=({partner:s,onClick:y})=>e.jsxs("tr",{onClick:y,className:"hover:bg-fill-tertiary/50 cursor-pointer transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.logo_url?e.jsx("img",{src:s.logo_url,alt:s.brand_name,className:"w-8 h-8 rounded"}):e.jsx("div",{className:"w-8 h-8 rounded flex items-center justify-center text-white font-bold text-sm",style:{backgroundColor:s.primary_color||"#4F46E5"},children:s.brand_name.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-label-primary",children:s.brand_name}),e.jsx("p",{className:"text-xs text-label-tertiary",children:s.slug})]})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-label-secondary",children:s.contact_email}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(E,{variant:s.status==="active"?"success":s.status==="suspended"?"warning":"default",children:s.status})}),e.jsx("td",{className:"px-4 py-3 text-sm text-label-secondary",children:s.site_count}),e.jsxs("td",{className:"px-4 py-3 text-sm text-label-secondary",children:[s.revenue_share_percent,"%"]}),e.jsx("td",{className:"px-4 py-3 text-sm text-label-tertiary",children:U(s.created_at)})]}),ee=({isOpen:s,onClose:y,onSubmit:p,isLoading:S})=>{const[o,P]=l.useState(""),[g,N]=l.useState(""),[b,j]=l.useState(""),[f,w]=l.useState(""),[v,k]=l.useState("#4F46E5"),[h,_]=l.useState(40);if(l.useEffect(()=>{const t=o.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"");N(t)},[o]),l.useEffect(()=>{!f&&o&&w(o)},[o]),!s)return null;const C=t=>{t.preventDefault(),p({name:o,slug:g,contact_email:b,brand_name:f,primary_color:v,revenue_share_percent:h})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs(x,{className:"w-full max-w-lg",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"New Partner"}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-label-secondary mb-1",children:"Partner Name *"}),e.jsx("input",{type:"text",value:o,onChange:t=>P(t.target.value),placeholder:"NEPA IT Solutions",className:"w-full px-3 py-2 rounded-ios bg-fill-secondary text-label-primary border border-separator-light focus:border-accent-primary focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-label-secondary mb-1",children:"Slug"}),e.jsx("input",{type:"text",value:g,onChange:t=>N(t.target.value),placeholder:"nepa-it",className:"w-full px-3 py-2 rounded-ios bg-fill-secondary text-label-primary border border-separator-light focus:border-accent-primary focus:outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-label-secondary mb-1",children:"Contact Email *"}),e.jsx("input",{type:"email",value:b,onChange:t=>j(t.target.value),placeholder:"partner@example.com",className:"w-full px-3 py-2 rounded-ios bg-fill-secondary text-label-primary border border-separator-light focus:border-accent-primary focus:outline-none",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-label-secondary mb-1",children:"Brand Name"}),e.jsx("input",{type:"text",value:f,onChange:t=>w(t.target.value),placeholder:"Partner Care",className:"w-full px-3 py-2 rounded-ios bg-fill-secondary text-label-primary border border-separator-light focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-label-secondary mb-1",children:"Brand Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:v,onChange:t=>k(t.target.value),className:"w-10 h-10 rounded cursor-pointer"}),e.jsx("input",{type:"text",value:v,onChange:t=>k(t.target.value),className:"flex-1 px-3 py-2 rounded-ios bg-fill-secondary text-label-primary border border-separator-light focus:border-accent-primary focus:outline-none"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-label-secondary mb-1",children:"Revenue Share (Partner %)"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"range",min:"10",max:"60",value:h,onChange:t=>_(parseInt(t.target.value)),className:"flex-1"}),e.jsxs("span",{className:"text-sm font-medium text-label-primary w-16",children:[h,"% / ",100-h,"%"]})]}),e.jsxs("p",{className:"text-xs text-label-tertiary mt-1",children:["Partner gets ",h,"%, OsirisCare gets ",100-h,"%"]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:y,className:"flex-1 px-4 py-2 rounded-ios bg-fill-secondary text-label-primary hover:bg-fill-tertiary transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!o||!b||S,className:"flex-1 px-4 py-2 rounded-ios bg-accent-primary text-white hover:bg-accent-primary/90 transition-colors disabled:opacity-50",children:S?"Creating...":"Create Partner"})]})]})]})})},te=({partner:s,onClose:y,onCopyApiKey:p})=>s?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs(x,{className:"w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-white font-bold text-xl",style:{backgroundColor:s.primary_color||"#4F46E5"},children:s.brand_name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-label-primary",children:s.brand_name}),e.jsx("p",{className:"text-sm text-label-tertiary",children:s.slug})]})]}),e.jsx(E,{variant:s.status==="active"?"success":"warning",children:s.status})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-label-tertiary uppercase",children:"Sites"}),e.jsx("p",{className:"text-2xl font-bold text-accent-primary",children:s.site_count})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-label-tertiary uppercase",children:"Revenue Share"}),e.jsxs("p",{className:"text-2xl font-bold text-label-primary",children:[s.revenue_share_percent,"%"]})]})]}),e.jsxs("div",{className:"border-t border-separator-light pt-4",children:[e.jsx("p",{className:"text-xs text-label-tertiary uppercase mb-2",children:"Contact"}),e.jsx("p",{className:"text-sm text-label-primary",children:s.contact_email})]}),e.jsxs("div",{className:"border-t border-separator-light pt-4",children:[e.jsx("p",{className:"text-xs text-label-tertiary uppercase mb-2",children:"Partner Dashboard"}),e.jsx("p",{className:"text-sm text-label-secondary",children:"Partners can access their dashboard at:"}),e.jsx("code",{className:"block mt-1 px-3 py-2 bg-fill-secondary rounded text-sm",children:"https://dashboard.osiriscare.net/partner/login"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsxs("button",{onClick:()=>p(s.id),className:"flex-1 px-4 py-2 rounded-ios bg-fill-secondary text-label-primary hover:bg-fill-tertiary transition-colors flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),"Regenerate API Key"]}),e.jsx("button",{onClick:y,className:"flex-1 px-4 py-2 rounded-ios bg-accent-primary text-white hover:bg-accent-primary/90 transition-colors",children:"Close"})]})]})]})}):null,ae=()=>{const[s,y]=l.useState([]),[p,S]=l.useState({total:0,recent:0,auth_events:0,unique_partners:0}),[o,P]=l.useState(!0),[g,N]=l.useState("all"),[b,j]=l.useState("all"),[f,w]=l.useState(""),v=l.useCallback(async()=>{const t=A();if(t){P(!0);try{const r=new URLSearchParams({limit:"200"});g!=="all"&&r.set("event_category",g),b!=="all"&&r.set("partner_id",b);const u=await fetch(`/api/partners/activity/all?${r}`,{headers:{Authorization:`Bearer ${t}`}});if(u.ok){const d=await u.json();y(d.logs||[]),d.stats&&S(d.stats)}}catch(r){console.error("Failed to fetch partner activity:",r)}finally{P(!1)}}},[g,b]);l.useEffect(()=>{v()},[v]);const k=Array.from(new Map(s.filter(t=>t.partner_name).map(t=>[t.partner_id,t.partner_name])).entries()),h=Array.from(new Set(s.map(t=>t.event_category))),_=s.filter(t=>{var u,d,c;if(!f)return!0;const r=f.toLowerCase();return((u=t.partner_name)==null?void 0:u.toLowerCase().includes(r))||t.event_type.toLowerCase().includes(r)||((d=t.target_id)==null?void 0:d.toLowerCase().includes(r))||((c=t.actor_ip)==null?void 0:c.toLowerCase().includes(r))||JSON.stringify(t.event_data).toLowerCase().includes(r)}),C=()=>{const t=[["Timestamp","Partner","Event","Category","Target","IP","Success","Details"].join(","),..._.map(c=>[c.created_at,`"${c.partner_name||c.partner_id}"`,c.event_type,c.event_category,`"${c.target_type?`${c.target_type}:${c.target_id||""}`:""}"`,c.actor_ip||"",c.success?"yes":"no",`"${JSON.stringify(c.event_data).replace(/"/g,'""')}"`].join(","))].join(`
`),r=new Blob([t],{type:"text/csv"}),u=URL.createObjectURL(r),d=document.createElement("a");d.href=u,d.download=`partner-activity-${new Date().toISOString().split("T")[0]}.csv`,d.click(),URL.revokeObjectURL(u)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(x,{padding:"md",children:[e.jsx("p",{className:"text-xs text-label-tertiary uppercase tracking-wide",children:"Total Events"}),e.jsx("p",{className:"text-2xl font-semibold mt-1",children:p.total})]}),e.jsxs(x,{padding:"md",children:[e.jsx("p",{className:"text-xs text-label-tertiary uppercase tracking-wide",children:"Last 24h"}),e.jsx("p",{className:"text-2xl font-semibold mt-1",children:p.recent})]}),e.jsxs(x,{padding:"md",children:[e.jsx("p",{className:"text-xs text-label-tertiary uppercase tracking-wide",children:"Auth Events"}),e.jsx("p",{className:"text-2xl font-semibold text-health-healthy mt-1",children:p.auth_events})]}),e.jsxs(x,{padding:"md",children:[e.jsx("p",{className:"text-xs text-label-tertiary uppercase tracking-wide",children:"Unique Partners"}),e.jsx("p",{className:"text-2xl font-semibold mt-1",children:p.unique_partners})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-label-tertiary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",placeholder:"Search activity...",value:f,onChange:t=>w(t.target.value),className:"w-full pl-10 pr-4 py-2 bg-white/50 border border-separator-light rounded-ios-md text-sm focus:outline-none focus:ring-2 focus:ring-accent-primary focus:border-transparent"})]}),e.jsxs("select",{value:g,onChange:t=>N(t.target.value),className:"px-4 py-2 bg-white/50 border border-separator-light rounded-ios-md text-sm focus:outline-none focus:ring-2 focus:ring-accent-primary",children:[e.jsx("option",{value:"all",children:"All Categories"}),h.map(t=>e.jsx("option",{value:t,children:t.charAt(0).toUpperCase()+t.slice(1)},t))]}),e.jsxs("select",{value:b,onChange:t=>j(t.target.value),className:"px-4 py-2 bg-white/50 border border-separator-light rounded-ios-md text-sm focus:outline-none focus:ring-2 focus:ring-accent-primary",children:[e.jsx("option",{value:"all",children:"All Partners"}),k.map(([t,r])=>e.jsx("option",{value:t,children:r},t))]}),e.jsxs("button",{onClick:C,className:"btn-secondary flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export CSV"]})]}),e.jsx(x,{padding:"none",children:o?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(I,{size:"lg"})}):_.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-12 h-12 text-label-tertiary mx-auto mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-label-secondary",children:"No partner activity found"}),e.jsx("p",{className:"text-label-tertiary text-sm mt-1",children:"Activity will appear here as partners use the system"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-fill-secondary border-b border-separator-light",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-label-secondary uppercase tracking-wider",children:"Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-label-secondary uppercase tracking-wider",children:"Partner"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-label-secondary uppercase tracking-wider",children:"Event"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-label-secondary uppercase tracking-wider",children:"Target"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-label-secondary uppercase tracking-wider",children:"Details"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-label-secondary uppercase tracking-wider",children:"IP"})]})}),e.jsx("tbody",{className:"divide-y divide-separator-light",children:_.map(t=>e.jsxs("tr",{className:"hover:bg-fill-tertiary/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-sm text-label-secondary font-mono whitespace-nowrap",children:X(t.created_at)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-sm font-medium text-label-primary",children:t.partner_name||t.partner_slug||t.partner_id.slice(0,8)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded whitespace-nowrap ${Q(t)}`,children:Y(t.event_type)})}),e.jsx("td",{className:"px-4 py-3",children:t.target_type?e.jsxs("span",{className:"text-sm text-label-primary",children:[t.target_type,t.target_id?`: ${t.target_id.slice(0,12)}`:""]}):e.jsx("span",{className:"text-sm text-label-tertiary",children:"-"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-sm text-label-tertiary max-w-[200px] truncate block",children:t.error_message?t.error_message:Object.keys(t.event_data).length>0?Object.entries(t.event_data).map(([r,u])=>`${r}: ${u}`).join(", "):"-"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-xs text-label-tertiary font-mono",children:t.actor_ip||"-"})})]},t.id))})]})})}),e.jsx(x,{padding:"sm",children:e.jsx("p",{className:"text-xs text-label-tertiary text-center",children:"Partner activity is logged to an append-only audit table for HIPAA 164.312(b) compliance."})})]})},re=()=>{const[s,y]=l.useState("partners"),[p,S]=l.useState([]),[o,P]=l.useState([]),[g,N]=l.useState(!0),[b,j]=l.useState(!1),[f,w]=l.useState(null),[v,k]=l.useState(!1),[h,_]=l.useState(void 0),[C,t]=l.useState(null),[r,u]=l.useState(null),[d,c]=l.useState(!1),[$,z]=l.useState(""),[M,T]=l.useState(!0),[B,R]=l.useState(!1);l.useEffect(()=>{L(),O(),q()},[]);const L=async()=>{N(!0);try{const a=await fetch("/api/partners");if(a.ok){const n=await a.json();S(n.partners||[])}}catch(a){console.error("Failed to fetch partners:",a)}finally{N(!1)}},O=async()=>{const a=A();if(a)try{const n=await fetch("/api/admin/partners/pending",{headers:{Authorization:`Bearer ${a}`}});if(n.ok){const i=await n.json();P(i.pending||[])}}catch(n){console.error("Failed to fetch pending partners:",n)}},q=async()=>{var n;const a=A();if(a)try{const i=await fetch("/api/admin/partners/oauth-config",{headers:{Authorization:`Bearer ${a}`}});if(i.ok){const m=await i.json();u(m),z(((n=m.allowed_domains)==null?void 0:n.join(", "))||""),T(m.require_approval??!0)}}catch(i){console.error("Failed to fetch OAuth config:",i)}},H=async()=>{const a=A();if(a){R(!0);try{const n=$.split(",").map(m=>m.trim().toLowerCase()).filter(m=>m),i=await fetch("/api/admin/partners/oauth-config",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({allowed_domains:n,require_approval:M,allow_consumer_gmail:(r==null?void 0:r.allow_consumer_gmail)??!0,notify_emails:(r==null?void 0:r.notify_emails)??[]})});if(i.ok)c(!1),q();else{const m=await i.json();alert(`Failed to save OAuth settings: ${m.detail||"Unknown error"}`)}}catch(n){console.error("Failed to save OAuth config:",n),alert("Failed to save OAuth settings")}finally{R(!1)}}},V=async a=>{const n=A();if(n){t(a);try{const i=await fetch(`/api/admin/partners/approve/${a}`,{method:"POST",headers:{Authorization:`Bearer ${n}`}});if(i.ok)O(),L();else{const m=await i.json();alert(`Failed to approve partner: ${m.detail||"Unknown error"}`)}}catch(i){console.error("Failed to approve partner:",i),alert("Failed to approve partner")}finally{t(null)}}},W=async a=>{if(!confirm("Are you sure you want to reject this partner signup? This will delete their account."))return;const n=A();if(n){t(a);try{const i=await fetch(`/api/admin/partners/reject/${a}`,{method:"POST",headers:{Authorization:`Bearer ${n}`}});if(i.ok)O();else{const m=await i.json();alert(`Failed to reject partner: ${m.detail||"Unknown error"}`)}}catch(i){console.error("Failed to reject partner:",i),alert("Failed to reject partner")}finally{t(null)}}},G=async a=>{k(!0);try{const n=await fetch("/api/partners",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(n.ok){const i=await n.json();j(!1),L(),i.api_key&&alert(`Partner created!

API Key (copy now, won't be shown again):
${i.api_key}`)}else{const i=await n.json();alert(`Failed to create partner: ${i.detail||"Unknown error"}`)}}catch(n){console.error("Failed to create partner:",n),alert("Failed to create partner")}finally{k(!1)}},J=async a=>{alert("API key regeneration not yet implemented. Contact engineering to reset partner API keys.")},D=h?p.filter(a=>a.status===h):p,F={total:p.length,active:p.filter(a=>a.status==="active").length,totalSites:p.reduce((a,n)=>a+n.site_count,0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-label-primary",children:"Partners"}),e.jsx("p",{className:"text-label-tertiary text-sm mt-1",children:"Manage MSP partners and resellers"})]}),s==="partners"&&e.jsx("button",{onClick:()=>j(!0),className:"btn-primary",children:"+ New Partner"})]}),e.jsx("div",{className:"flex gap-1 border-b border-separator-light",children:[{key:"partners",label:"Partners"},{key:"activity",label:"Activity Log"}].map(a=>e.jsxs("button",{onClick:()=>y(a.key),className:`px-4 py-2.5 text-sm font-medium transition-colors relative ${s===a.key?"text-accent-primary":"text-label-tertiary hover:text-label-secondary"}`,children:[a.label,s===a.key&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-accent-primary rounded-t"})]},a.key))}),s==="activity"&&e.jsx(ae,{}),s==="partners"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(x,{padding:"md",className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-accent-primary",children:F.total}),e.jsx("p",{className:"text-xs text-label-tertiary",children:"Total Partners"})]}),e.jsxs(x,{padding:"md",className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-health-healthy",children:F.active}),e.jsx("p",{className:"text-xs text-label-tertiary",children:"Active"})]}),e.jsxs(x,{padding:"md",className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-label-primary",children:F.totalSites}),e.jsx("p",{className:"text-xs text-label-tertiary",children:"Total Sites"})]}),e.jsxs(x,{padding:"md",className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-health-warning",children:o.length}),e.jsx("p",{className:"text-xs text-label-tertiary",children:"Pending Approval"})]})]}),o.length>0&&e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-health-warning animate-pulse"}),e.jsx("h2",{className:"text-lg font-semibold text-label-primary",children:"Pending Partner Approvals"}),e.jsx(E,{variant:"warning",children:o.length})]}),e.jsx("div",{className:"space-y-3",children:o.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-fill-secondary rounded-lg border border-separator-light",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-health-warning/20 flex items-center justify-center",children:a.auth_provider==="google"?e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}):e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 21 21",children:[e.jsx("rect",{fill:"#f25022",x:"1",y:"1",width:"9",height:"9"}),e.jsx("rect",{fill:"#7fba00",x:"11",y:"1",width:"9",height:"9"}),e.jsx("rect",{fill:"#05a6f0",x:"1",y:"11",width:"9",height:"9"}),e.jsx("rect",{fill:"#ffba08",x:"11",y:"11",width:"9",height:"9"})]})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-label-primary",children:a.name}),e.jsx("p",{className:"text-sm text-label-secondary",children:a.oauth_email}),e.jsxs("p",{className:"text-xs text-label-tertiary",children:["Signed up via ",a.auth_provider==="google"?"Google":"Microsoft"," on ",U(a.created_at)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>W(a.id),disabled:C===a.id,className:"px-3 py-1.5 text-sm rounded-ios bg-health-critical/10 text-health-critical hover:bg-health-critical/20 transition-colors disabled:opacity-50",children:"Reject"}),e.jsx("button",{onClick:()=>V(a.id),disabled:C===a.id,className:"px-3 py-1.5 text-sm rounded-ios bg-health-healthy text-white hover:bg-health-healthy/90 transition-colors disabled:opacity-50",children:C===a.id?"Processing...":"Approve"})]})]},a.id))})]}),e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-accent-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),e.jsx("h2",{className:"text-lg font-semibold text-label-primary",children:"Partner OAuth Settings"})]}),e.jsx("button",{onClick:()=>c(!d),className:"text-sm text-accent-primary hover:underline",children:d?"Hide":"Configure"})]}),!d&&r&&e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm",children:[e.jsx("span",{className:"px-2 py-1 rounded bg-fill-secondary text-label-secondary",children:r.require_approval?"Approval Required":"Auto-approve"}),r.allowed_domains.length>0?e.jsxs("span",{className:"px-2 py-1 rounded bg-health-healthy/20 text-health-healthy",children:[r.allowed_domains.length," domain",r.allowed_domains.length!==1?"s":""," whitelisted"]}):e.jsx("span",{className:"px-2 py-1 rounded bg-health-warning/20 text-health-warning",children:"No domains whitelisted"})]}),d&&e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-label-primary mb-1",children:"Whitelisted Domains (Auto-Approve)"}),e.jsx("input",{type:"text",value:$,onChange:a=>z(a.target.value),placeholder:"company.com, partner.net",className:"w-full px-3 py-2 border border-separator-light rounded-ios focus:ring-2 focus:ring-accent-primary focus:border-transparent bg-fill-primary"}),e.jsx("p",{className:"text-xs text-label-tertiary mt-1",children:"Partners from these domains are automatically approved. Comma-separated."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"requireApproval",checked:M,onChange:a=>T(a.target.checked),className:"rounded"}),e.jsx("label",{htmlFor:"requireApproval",className:"text-sm text-label-primary",children:"Require admin approval for new partners (except whitelisted domains)"})]}),(r==null?void 0:r.allowed_domains)&&r.allowed_domains.length>0&&e.jsxs("div",{className:"p-3 bg-fill-secondary rounded-ios",children:[e.jsx("p",{className:"text-xs text-label-secondary mb-2",children:"Currently whitelisted:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.allowed_domains.map(a=>e.jsx("span",{className:"px-2 py-1 bg-health-healthy/20 text-health-healthy text-xs rounded",children:a},a))})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 text-sm text-label-secondary hover:bg-fill-tertiary rounded-ios",children:"Cancel"}),e.jsx("button",{onClick:H,disabled:B,className:"px-4 py-2 text-sm bg-accent-primary text-white rounded-ios hover:bg-accent-primary/90 disabled:opacity-50",children:B?"Saving...":"Save Settings"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-label-tertiary",children:"Filter:"}),e.jsx("div",{className:"flex gap-1",children:[{value:void 0,label:"All"},{value:"active",label:"Active"},{value:"suspended",label:"Suspended"},{value:"inactive",label:"Inactive"}].map(a=>e.jsx("button",{onClick:()=>_(a.value),className:`px-3 py-1.5 text-sm rounded-ios-sm transition-colors ${h===a.value?"bg-accent-primary text-white":"bg-separator-light text-label-secondary hover:bg-separator-light/80"}`,children:a.label},a.value||"all"))})]}),e.jsx(x,{padding:"none",children:g?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(I,{size:"lg"})}):D.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-accent-primary/10 flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-accent-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsx("h3",{className:"font-semibold text-label-primary mb-2",children:"No partners yet"}),e.jsx("p",{className:"text-label-tertiary text-sm mb-4",children:'Click "New Partner" to add your first reseller.'}),e.jsx("button",{onClick:()=>j(!0),className:"btn-primary",children:"+ New Partner"})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-fill-secondary border-b border-separator-light",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-label-secondary uppercase tracking-wider",children:"Partner"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-label-secondary uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-label-secondary uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-label-secondary uppercase tracking-wider",children:"Sites"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-label-secondary uppercase tracking-wider",children:"Revenue %"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-label-secondary uppercase tracking-wider",children:"Created"})]})}),e.jsx("tbody",{className:"divide-y divide-separator-light",children:D.map(a=>e.jsx(Z,{partner:a,onClick:()=>w(a)},a.id))})]})})]}),e.jsx(ee,{isOpen:b,onClose:()=>j(!1),onSubmit:G,isLoading:v}),e.jsx(te,{partner:f,onClose:()=>w(null),onCopyApiKey:J})]})};export{re as Partners,re as default};
