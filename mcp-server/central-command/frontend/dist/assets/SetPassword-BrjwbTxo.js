import{m as P,Z as L,r as s,a7 as y,j as e,G as c,S as m}from"./index-ByrxzNCH.js";function M(){const o=P(),[g]=L(),l=g.get("token"),[v,x]=s.useState(!0),[t,d]=s.useState(null),[r,w]=s.useState(""),[n,N]=s.useState(""),[u,p]=s.useState(!1),[h,i]=s.useState(null),[k,S]=s.useState(!1);s.useEffect(()=>{if(!l){x(!1),d({valid:!1,error:"No invite token provided"});return}y.validateInvite(l).then(a=>{d(a)}).catch(()=>{d({valid:!1,error:"Failed to validate invite"})}).finally(()=>{x(!1)})},[l]);const C=async a=>{if(a.preventDefault(),!(!l||!(t!=null&&t.valid))){if(r!==n){i("Passwords do not match");return}if(r.length<12){i("Password must be at least 12 characters");return}p(!0),i(null);try{await y.acceptInvite({token:l,password:r,confirm_password:n}),S(!0),setTimeout(()=>{o("/")},3e3)}catch(j){i(j instanceof Error?j.message:"Failed to set password")}finally{p(!1)}}},f=r===n,b=r.length>=12;return v?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:e.jsxs(c,{className:"w-full max-w-md text-center py-12",children:[e.jsx(m,{}),e.jsx("p",{className:"mt-4 text-label-secondary",children:"Validating invite..."})]})}):t!=null&&t.valid?k?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:e.jsxs(c,{className:"w-full max-w-md text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-6 rounded-full bg-green-500/20 flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h1",{className:"text-2xl font-bold text-label-primary mb-2",children:"Account Created!"}),e.jsx("p",{className:"text-label-tertiary mb-6",children:"Your password has been set. Redirecting to login..."}),e.jsx(m,{})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:e.jsxs(c,{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-accent-primary/20 flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-accent-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),e.jsx("h1",{className:"text-2xl font-bold text-label-primary",children:"Set Your Password"}),e.jsx("p",{className:"text-label-tertiary mt-2",children:"Welcome to Central Command! Set your password to activate your account."})]}),e.jsx("div",{className:"bg-fill-secondary rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-label-tertiary",children:"Email:"}),e.jsx("p",{className:"text-label-primary font-medium",children:t.email})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-label-tertiary",children:"Role:"}),e.jsx("p",{className:"text-label-primary font-medium capitalize",children:t.role})]})]})}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-label-secondary mb-1",children:"Password"}),e.jsx("input",{type:"password",value:r,onChange:a=>w(a.target.value),className:"w-full px-4 py-3 bg-fill-secondary border border-separator-default rounded-lg text-label-primary focus:outline-none focus:border-accent-primary",placeholder:"Minimum 12 characters",required:!0}),r&&!b&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:"Password must be at least 12 characters"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-label-secondary mb-1",children:"Confirm Password"}),e.jsx("input",{type:"password",value:n,onChange:a=>N(a.target.value),className:"w-full px-4 py-3 bg-fill-secondary border border-separator-default rounded-lg text-label-primary focus:outline-none focus:border-accent-primary",placeholder:"Re-enter your password",required:!0}),n&&!f&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:"Passwords do not match"})]}),h&&e.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm",children:h}),e.jsx("button",{type:"submit",disabled:u||!b||!f,className:"w-full py-3 bg-accent-primary text-white rounded-lg font-medium hover:bg-accent-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?e.jsx(m,{size:"sm"}):"Create Account"})]}),e.jsxs("p",{className:"text-center text-label-tertiary text-sm mt-6",children:["Already have an account?"," ",e.jsx("button",{onClick:()=>o("/"),className:"text-accent-primary hover:underline",children:"Sign in"})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:e.jsxs(c,{className:"w-full max-w-md text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-6 rounded-full bg-red-500/20 flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h1",{className:"text-2xl font-bold text-label-primary mb-2",children:"Invalid Invite"}),e.jsx("p",{className:"text-label-tertiary mb-6",children:(t==null?void 0:t.error)||"This invite link is invalid or has expired."}),e.jsx("button",{onClick:()=>o("/"),className:"px-6 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors",children:"Go to Login"})]})})}export{M as default};
