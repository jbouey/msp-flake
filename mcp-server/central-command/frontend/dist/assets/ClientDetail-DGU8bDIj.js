import{s as N,m as b,t as y,v as g,j as e,S as v,G as l,H as o,I as w}from"./index-ByrxzNCH.js";const _=()=>{const{siteId:c}=N(),h=b(),{data:t,isLoading:x,error:m}=y(c||null),{data:i=[]}=g({site_id:c,limit:10}),j=s=>s.charAt(0).toUpperCase()+s.slice(1),n=s=>s>=100?{text:"PASS",color:"text-health-healthy"}:s>=50?{text:"WARN",color:"text-health-warning"}:{text:"FAIL",color:"text-health-critical"},f=s=>{if(!s)return"Never";const r=new Date(s),u=new Date().getTime()-r.getTime(),a=Math.floor(u/6e4);return a<1?"Just now":a<60?`${a}m ago`:a<1440?`${Math.floor(a/60)}h ago`:r.toLocaleDateString()};if(x)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(v,{size:"lg"})});if(m||!t)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] text-center",children:[e.jsx("div",{className:"w-16 h-16 mb-4 rounded-full bg-health-critical/10 flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-health-critical",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h2",{className:"text-xl font-semibold text-label-primary mb-2",children:"Client Not Found"}),e.jsxs("p",{className:"text-label-tertiary mb-4",children:['Could not load data for "',c,'"']}),e.jsx("button",{onClick:()=>h("/"),className:"btn-primary",children:"Return to Dashboard"})]});const p=["patching","antivirus","backup","logging","firewall","encryption"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>h("/"),className:"p-2 hover:bg-separator-light rounded-ios-sm transition-colors","aria-label":"Back to dashboard",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-label-primary",children:t.name}),e.jsxs("p",{className:"text-label-tertiary",children:[t.tier," Tier"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(l,{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(o,{score:t.health.overall,size:"xl"}),e.jsx("p",{className:"mt-4 text-sm text-label-tertiary",children:"Overall Health"})]}),e.jsxs(l,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold",children:"Connectivity"}),e.jsxs("span",{className:"text-lg font-bold text-accent-primary",children:[t.health.connectivity.score.toFixed(0),"%"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-label-secondary",children:"Check-in Freshness"}),e.jsxs("span",{className:`font-medium ${n(t.health.connectivity.checkin_freshness).color}`,children:[t.health.connectivity.checkin_freshness,"%"]})]}),e.jsx("div",{className:"h-1.5 bg-separator-light rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-accent-primary rounded-full transition-all",style:{width:`${t.health.connectivity.checkin_freshness}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-label-secondary",children:"Healing Success"}),e.jsxs("span",{className:`font-medium ${n(t.health.connectivity.healing_success_rate).color}`,children:[t.health.connectivity.healing_success_rate,"%"]})]}),e.jsx("div",{className:"h-1.5 bg-separator-light rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-accent-primary rounded-full transition-all",style:{width:`${t.health.connectivity.healing_success_rate}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-label-secondary",children:"Order Execution"}),e.jsxs("span",{className:`font-medium ${n(t.health.connectivity.order_execution_rate).color}`,children:[t.health.connectivity.order_execution_rate,"%"]})]}),e.jsx("div",{className:"h-1.5 bg-separator-light rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-accent-primary rounded-full transition-all",style:{width:`${t.health.connectivity.order_execution_rate}%`}})})]})]})]}),e.jsxs(l,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold",children:"Compliance"}),e.jsxs("span",{className:"text-lg font-bold text-accent-primary",children:[t.health.compliance.score.toFixed(0),"%"]})]}),e.jsx("div",{className:"space-y-2",children:p.map(s=>{const r=t.compliance_breakdown[s]??0,d=n(r*100);return e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-label-secondary",children:j(s)}),e.jsx("span",{className:`font-medium ${d.color}`,children:d.text})]},s)})})]})]}),e.jsxs(l,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold",children:["Appliances (",t.appliances.length,")"]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-label-tertiary",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-health-healthy"}),t.appliances.filter(s=>s.is_online).length," online"]})]}),t.appliances.length===0?e.jsx("p",{className:"text-label-tertiary text-center py-8",children:"No appliances registered for this client."}):e.jsx("div",{className:"space-y-3",children:t.appliances.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-separator-light/50 rounded-ios-md",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${s.is_online?"bg-health-healthy":"bg-health-critical"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-label-primary",children:s.hostname}),e.jsxs("p",{className:"text-xs text-label-tertiary",children:[s.ip_address||"No IP"," | v",s.agent_version||"?"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right text-xs text-label-tertiary",children:[e.jsx("p",{children:"Last check-in"}),e.jsx("p",{className:"font-medium text-label-secondary",children:f(s.last_checkin)})]}),s.health&&e.jsx(o,{score:s.health.overall,size:"sm"})]})]},s.id))})]}),e.jsxs(l,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Recent Incidents"}),e.jsx("span",{className:"text-sm text-label-tertiary",children:"Last 10"})]}),i.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-full bg-health-healthy/10 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-health-healthy",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("p",{className:"text-label-secondary font-medium",children:"No recent incidents"}),e.jsx("p",{className:"text-label-tertiary text-sm",children:"This client has been running smoothly."})]}):e.jsx("div",{className:"space-y-2",children:i.map(s=>e.jsx(w,{incident:s},s.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(l,{padding:"md",className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-label-primary",children:t.appliances.length}),e.jsx("p",{className:"text-sm text-label-tertiary",children:"Total Appliances"})]}),e.jsxs(l,{padding:"md",className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-health-healthy",children:t.appliances.filter(s=>s.is_online).length}),e.jsx("p",{className:"text-sm text-label-tertiary",children:"Online"})]}),e.jsxs(l,{padding:"md",className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-label-primary",children:i.filter(s=>!s.resolved).length}),e.jsx("p",{className:"text-sm text-label-tertiary",children:"Open Incidents"})]}),e.jsxs(l,{padding:"md",className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-accent-primary",children:i.filter(s=>s.resolution_level==="L1").length}),e.jsx("p",{className:"text-sm text-label-tertiary",children:"L1 Resolved"})]})]})]})};export{_ as ClientDetail,_ as default};
