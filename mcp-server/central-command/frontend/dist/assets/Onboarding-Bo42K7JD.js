import{m as N,r as c,n as w,o as k,p as C,j as e,q as S,G as n,S as P,O as _}from"./index-D3EplXpq.js";const L=({isOpen:j,onClose:o,onSubmit:g,isLoading:x})=>{const[l,d]=c.useState(""),[m,s]=c.useState(""),[r,h]=c.useState(""),[p,y]=c.useState("mid");if(!j)return null;const v=a=>{a.preventDefault(),g({clinic_name:l,contact_name:m||void 0,contact_email:r||void 0,tier:p})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs(n,{className:"w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"New Prospect"}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-label-secondary mb-1",children:"Clinic Name *"}),e.jsx("input",{type:"text",value:l,onChange:a=>d(a.target.value),placeholder:"e.g., Acme Dental",className:"w-full px-3 py-2 rounded-ios bg-fill-secondary text-label-primary border border-separator-light focus:border-accent-primary focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-label-secondary mb-1",children:"Contact Name"}),e.jsx("input",{type:"text",value:m,onChange:a=>s(a.target.value),placeholder:"e.g., Dr. Smith",className:"w-full px-3 py-2 rounded-ios bg-fill-secondary text-label-primary border border-separator-light focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-label-secondary mb-1",children:"Contact Email"}),e.jsx("input",{type:"email",value:r,onChange:a=>h(a.target.value),placeholder:"e.g., contact@acmedental.com",className:"w-full px-3 py-2 rounded-ios bg-fill-secondary text-label-primary border border-separator-light focus:border-accent-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-label-secondary mb-1",children:"Practice Size"}),e.jsxs("select",{value:p,onChange:a=>y(a.target.value),className:"w-full px-3 py-2 rounded-ios bg-fill-secondary text-label-primary border border-separator-light focus:border-accent-primary focus:outline-none",children:[e.jsx("option",{value:"small",children:"Small (1-5 providers)"}),e.jsx("option",{value:"mid",children:"Mid (6-15 providers)"}),e.jsx("option",{value:"large",children:"Large (15-50 providers)"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:o,className:"flex-1 px-4 py-2 rounded-ios bg-fill-secondary text-label-primary hover:bg-fill-tertiary transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!l||x,className:"flex-1 px-4 py-2 rounded-ios bg-accent-primary text-white hover:bg-accent-primary/90 transition-colors disabled:opacity-50",children:x?"Creating...":"Add Prospect"})]})]})]})})},A=()=>{const j=N(),[o,g]=c.useState("all"),[x,l]=c.useState(!1),{data:d=[],isLoading:m}=w(),{data:s,isLoading:r}=k(),h=C(),p=async t=>{try{const i=await h.mutateAsync(t);l(!1),j(`/sites/${i.site_id}`)}catch(i){console.error("Failed to create prospect:",i)}},y=["lead","discovery","proposal","contract","intake","creds","shipped"],v=["received","connectivity","scanning","baseline","compliant","active"],a=d.filter(t=>o==="all"?t.stage!=="active":o===1?y.includes(t.stage):v.includes(t.stage)&&t.stage!=="active"),f=d.filter(t=>t.stage==="active"),u=[...a].sort((t,i)=>(i.days_in_stage??0)-(t.days_in_stage??0)),b=d.filter(t=>{var i;return(((i=t.blockers)==null?void 0:i.length)??0)>0});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-label-primary",children:"Onboarding Pipeline"}),e.jsxs("p",{className:"text-label-tertiary text-sm mt-1",children:[(s==null?void 0:s.total_prospects)??0," active prospects"]})]}),e.jsx("button",{onClick:()=>l(!0),className:"btn-primary",children:"+ New Prospect"})]}),e.jsx(S,{metrics:s,isLoading:r}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(n,{padding:"md",className:"text-center",children:[e.jsx("p",{className:`text-2xl font-bold ${((s==null?void 0:s.at_risk_count)??0)>0?"text-health-warning":"text-label-primary"}`,children:r?"-":(s==null?void 0:s.at_risk_count)??0}),e.jsx("p",{className:"text-xs text-label-tertiary",children:"At Risk (>7 days)"})]}),e.jsxs(n,{padding:"md",className:"text-center",children:[e.jsx("p",{className:`text-2xl font-bold ${((s==null?void 0:s.stalled_count)??0)>0?"text-health-critical":"text-label-primary"}`,children:r?"-":(s==null?void 0:s.stalled_count)??0}),e.jsx("p",{className:"text-xs text-label-tertiary",children:"Stalled (>14 days)"})]}),e.jsxs(n,{padding:"md",className:"text-center",children:[e.jsx("p",{className:`text-2xl font-bold ${((s==null?void 0:s.connectivity_issues)??0)>0?"text-health-critical":"text-label-primary"}`,children:r?"-":(s==null?void 0:s.connectivity_issues)??0}),e.jsx("p",{className:"text-xs text-label-tertiary",children:"Connectivity Issues"})]}),e.jsxs(n,{padding:"md",className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-accent-primary",children:r?"-":f.length}),e.jsx("p",{className:"text-xs text-label-tertiary",children:"Recently Activated"})]})]}),b.length>0&&e.jsx(n,{className:"border-l-4 border-health-warning",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-health-warning/20 flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-4 h-4 text-health-warning",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-label-primary",children:[b.length," Prospect",b.length>1?"s":""," with Blockers"]}),e.jsx("p",{className:"text-sm text-label-secondary mt-1",children:b.map(t=>t.name).join(", ")})]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-label-tertiary",children:"Show:"}),e.jsx("div",{className:"flex gap-1",children:[{value:"all",label:"All"},{value:1,label:"Phase 1"},{value:2,label:"Phase 2"}].map(t=>e.jsx("button",{onClick:()=>g(t.value),className:`px-3 py-1.5 text-sm rounded-ios-sm transition-colors ${o===t.value?"bg-accent-primary text-white":"bg-separator-light text-label-secondary hover:bg-separator-light/80"}`,children:t.label},t.value))}),e.jsxs("span",{className:"text-sm text-label-tertiary ml-4",children:[u.length," prospect",u.length!==1?"s":""]})]}),m?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(P,{size:"lg"})}):u.length===0?e.jsxs(n,{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-accent-primary/10 flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-accent-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})})}),e.jsx("h3",{className:"font-semibold text-label-primary mb-2",children:"No prospects in pipeline"}),e.jsx("p",{className:"text-label-tertiary text-sm mb-4",children:'Click "New Prospect" to add your first client.'}),e.jsx("button",{onClick:()=>l(!0),className:"btn-primary",children:"+ New Prospect"})]}):e.jsx("div",{className:"space-y-4",children:u.map(t=>e.jsx(_,{client:t},t.id))}),f.length>0&&e.jsxs(n,{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Recently Activated"}),e.jsx("div",{className:"space-y-2",children:f.slice(0,5).map(t=>e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-separator-light last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-health-healthy/20 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-health-healthy",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-label-primary",children:t.name}),e.jsx("p",{className:"text-xs text-label-tertiary",children:t.site_id&&`Site: ${t.site_id}`})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-health-healthy",children:"Active"}),e.jsx("p",{className:"text-xs text-label-tertiary",children:t.active_at?new Date(t.active_at).toLocaleDateString():"Recently"})]})]},t.id))})]}),e.jsx(L,{isOpen:x,onClose:()=>l(!1),onSubmit:p,isLoading:h.isPending})]})};export{A as Onboarding,A as default};
