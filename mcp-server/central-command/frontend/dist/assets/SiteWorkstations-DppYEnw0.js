import{s as b,N as f,j as e,S as g,G as d,K as o,B as u,r as h}from"./index-Dfzg2dGd.js";import{W as j,a as N}from"./index-CJjopUK2.js";function y(t){if(!t)return"Never";const r=new Date(t),n=new Date().getTime()-r.getTime(),a=Math.floor(n/6e4);if(a<1)return"Just now";if(a<60)return`${a} min ago`;const l=Math.floor(a/60);return l<24?`${l}h ago`:`${Math.floor(l/24)}d ago`}const p={compliant:"bg-health-healthy text-white",drifted:"bg-health-warning text-white",error:"bg-health-critical text-white",unknown:"bg-gray-400 text-white",offline:"bg-gray-500 text-white"},v={compliant:"Compliant",drifted:"Drifted",error:"Error",unknown:"Unknown",offline:"Offline"},w=({summary:t})=>{const r=t.overall_compliance_rate||0,c=r>=80?"text-health-healthy":r>=50?"text-health-warning":"text-health-critical";return e.jsxs(d,{className:"p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-label-primary mb-4",children:"Workstation Fleet Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-3xl font-bold ${c}`,children:[r.toFixed(0),"%"]}),e.jsx("div",{className:"text-sm text-label-secondary",children:"Compliance"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-label-primary",children:t.total_workstations}),e.jsx("div",{className:"text-sm text-label-secondary",children:"Total"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-400",children:t.online_workstations}),e.jsx("div",{className:"text-sm text-label-secondary",children:"Online"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-health-healthy",children:t.compliant_workstations}),e.jsx("div",{className:"text-sm text-label-secondary",children:"Compliant"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-health-warning",children:t.drifted_workstations}),e.jsx("div",{className:"text-sm text-label-secondary",children:"Drifted"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-health-critical",children:t.error_workstations}),e.jsx("div",{className:"text-sm text-label-secondary",children:"Error"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-gray-400",children:t.unknown_workstations}),e.jsx("div",{className:"text-sm text-label-secondary",children:"Unknown"})]})]}),t.check_compliance&&Object.keys(t.check_compliance).length>0&&e.jsxs("div",{className:"mt-6 pt-4 border-t border-glass-border",children:[e.jsx("h3",{className:"text-sm font-medium text-label-secondary mb-3",children:"Check Compliance Rates"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:Object.entries(t.check_compliance).map(([n,a])=>e.jsxs("div",{className:"bg-glass-bg/50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-sm font-medium text-label-primary",children:j[n]||n}),e.jsxs("div",{className:`text-xl font-bold ${a.rate>=80?"text-health-healthy":a.rate>=50?"text-health-warning":"text-health-critical"}`,children:[a.rate.toFixed(0),"%"]}),e.jsxs("div",{className:"text-xs text-label-tertiary",children:[a.compliant,"/",a.compliant+a.drifted+a.error]})]},n))})]})]})},k=({workstation:t,expanded:r,onToggle:c})=>{const n=p[t.compliance_status]||p.unknown,a=v[t.compliance_status]||"Unknown";return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"hover:bg-glass-bg/30 cursor-pointer transition-colors",onClick:c,children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${t.online?"bg-health-healthy":"bg-gray-500"}`}),e.jsx("span",{className:"font-medium text-label-primary",children:t.hostname})]})}),e.jsx("td",{className:"px-4 py-3 text-label-secondary",children:t.ip_address||"-"}),e.jsx("td",{className:"px-4 py-3 text-label-secondary text-sm",children:t.os_name||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${n}`,children:a})}),e.jsx("td",{className:"px-4 py-3 text-label-secondary text-sm",children:y(t.last_compliance_check)}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("svg",{className:`w-5 h-5 text-label-tertiary transition-transform ${r?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),r&&t.checks&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-3 bg-glass-bg/20",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:["bitlocker","defender","patches","firewall","screen_lock"].map(l=>{var m;const s=(m=t.checks)==null?void 0:m[l],i=(s==null?void 0:s.compliant)??!1,x=(s==null?void 0:s.status)||"unknown";return e.jsxs("div",{className:`p-3 rounded-lg border ${i?"border-health-healthy/30 bg-health-healthy/10":x==="error"?"border-health-critical/30 bg-health-critical/10":x==="drifted"?"border-health-warning/30 bg-health-warning/10":"border-gray-500/30 bg-gray-500/10"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-label-primary",children:j[l]}),i?e.jsx("svg",{className:"w-4 h-4 text-health-healthy",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}):e.jsx("svg",{className:"w-4 h-4 text-health-critical",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})]}),e.jsx("div",{className:"text-xs text-label-tertiary",children:N[l]})]},l)})})})})]})},_=({workstations:t})=>{const[r,c]=h.useState(null),[n,a]=h.useState("all"),l=t.filter(s=>{switch(n){case"online":return s.online;case"compliant":return s.compliance_status==="compliant";case"drifted":return s.compliance_status==="drifted"||s.compliance_status==="error";default:return!0}});return e.jsxs(d,{className:"overflow-hidden",children:[e.jsx("div",{className:"flex gap-2 p-4 border-b border-glass-border",children:["all","online","compliant","drifted"].map(s=>e.jsxs("button",{onClick:()=>a(s),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${n===s?"bg-accent-primary text-white":"text-label-secondary hover:bg-glass-bg/50"}`,children:[s.charAt(0).toUpperCase()+s.slice(1),e.jsxs("span",{className:"ml-1 text-xs opacity-70",children:["(",s==="all"?t.length:s==="online"?t.filter(i=>i.online).length:s==="compliant"?t.filter(i=>i.compliance_status==="compliant").length:t.filter(i=>i.compliance_status==="drifted"||i.compliance_status==="error").length,")"]})]},s))}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-glass-border",children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-label-secondary",children:"Hostname"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-label-secondary",children:"IP Address"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-label-secondary",children:"OS"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-label-secondary",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-label-secondary",children:"Last Check"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-label-secondary"})]})}),e.jsx("tbody",{children:l.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-label-tertiary",children:"No workstations found"})}):l.map(s=>e.jsx(k,{workstation:s,expanded:r===s.id,onToggle:()=>c(r===s.id?null:s.id)},s.id))})]})})]})},S=()=>{const{siteId:t}=b(),{data:r,isLoading:c,error:n}=f(t||"");if(c)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(g,{size:"lg"})});if(n)return e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"text-center text-health-critical",children:[e.jsx("p",{children:"Failed to load workstations"}),e.jsx("p",{className:"text-sm text-label-secondary mt-2",children:n.message})]})});const{summary:a,workstations:l}=r||{summary:null,workstations:[]};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(o,{to:"/sites",className:"text-label-secondary hover:text-label-primary",children:"Sites"}),e.jsx("span",{className:"text-label-tertiary",children:"/"}),e.jsx(o,{to:`/sites/${t}`,className:"text-label-secondary hover:text-label-primary",children:t}),e.jsx("span",{className:"text-label-tertiary",children:"/"}),e.jsx("span",{className:"text-label-primary",children:"Workstations"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-label-primary",children:"Workstation Compliance"}),e.jsx("p",{className:"text-label-secondary mt-1",children:"Monitor and track compliance status for all workstations at this site"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(o,{to:`/sites/${t}/workstations/rmm-compare`,className:"px-4 py-2 bg-accent-primary/10 text-accent-primary hover:bg-accent-primary/20 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"RMM Compare"]}),e.jsxs(u,{variant:"info",className:"px-3 py-1",children:[l.length," Workstations"]})]})]}),a&&e.jsx(w,{summary:a}),e.jsx(_,{workstations:l})]})};export{S as SiteWorkstations,S as default};
