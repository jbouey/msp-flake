[
  {
    "id": "L1-NTP-001",
    "name": "NTP Drift Remediation",
    "description": "Restart chronyd when NTP sync drifts",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "ntp_sync"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "restart_service"
    ],
    "action_params": {
      "service_name": "chronyd"
    },
    "severity": "medium",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-SERVICE-001",
    "name": "Critical Service Recovery",
    "description": "Restart failed critical services",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "critical_services"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "restart_service"
    ],
    "action_params": {
      "service_name": "sshd"
    },
    "severity": "high",
    "cooldown_seconds": 600,
    "max_retries": 3,
    "source": "builtin"
  },
  {
    "id": "L1-NIXOS-FW-001",
    "name": "NixOS Firewall Alert",
    "description": "Escalate NixOS firewall issues (declarative - cannot auto-fix)",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "firewall"
      },
      {
        "field": "platform",
        "operator": "eq",
        "value": "nixos"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "escalate"
    ],
    "action_params": {
      "reason": "NixOS firewall is declarative, requires manual nix config update"
    },
    "severity": "medium",
    "cooldown_seconds": 3600,
    "max_retries": 1,
    "source": "custom",
    "priority": 1
  },
  {
    "id": "L1-FIREWALL-001",
    "name": "Windows Firewall Recovery",
    "description": "Re-enable Windows Firewall when disabled (Windows only - must be IP-based host)",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "firewall"
      },
      {
        "field": "platform",
        "operator": "ne",
        "value": "nixos"
      },
      {
        "field": "host_id",
        "operator": "regex",
        "value": "^[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+$"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-FIREWALL-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "critical",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin",
    "priority": 10
  },
  {
    "id": "L1-FIREWALL-002",
    "name": "Windows Firewall Status Recovery",
    "description": "Re-enable Windows Firewall when status check fails (Windows only - must be IP-based host)",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "firewall_status"
      },
      {
        "field": "host_id",
        "operator": "regex",
        "value": "^[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+$"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-FIREWALL-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "critical",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-DEFENDER-001",
    "name": "Windows Defender Recovery",
    "description": "Re-enable Windows Defender when disabled",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "windows_defender"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-AV-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "critical",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-DISK-001",
    "name": "Disk Space Alert",
    "description": "Escalate when disk usage critical",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "disk_space"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "escalate"
    ],
    "action_params": {
      "reason": "Disk space critical, manual cleanup required"
    },
    "severity": "high",
    "cooldown_seconds": 3600,
    "max_retries": 1,
    "source": "builtin"
  },
  {
    "id": "L1-AUDIT-001",
    "name": "Audit Policy Remediation",
    "description": "Restore HIPAA-required Windows audit policies",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "audit_policy"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SEC-002",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 600,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-PASSWORD-001",
    "name": "Password Policy Enforcement",
    "description": "Restore HIPAA-required password policy settings",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "password_policy"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SEC-004",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 600,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-LOCKOUT-001",
    "name": "Account Lockout Policy Reset",
    "description": "Restore account lockout threshold settings",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "lockout_policy"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SEC-003",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "medium",
    "cooldown_seconds": 600,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-SMB-001",
    "name": "SMB Signing Enforcement",
    "description": "Enable SMB signing to prevent MITM attacks",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "smb_signing"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SEC-007",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 600,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-NTLM-001",
    "name": "NTLM Security Hardening",
    "description": "Configure NTLM security to prevent credential relay attacks",
    "conditions": [
      {
        "field": "check_type",
        "operator": "in",
        "value": [
          "ntlm_security",
          "ntlm"
        ]
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SEC-008",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 900,
    "max_retries": 1,
    "source": "builtin"
  },
  {
    "id": "L1-BACKDOOR-001",
    "name": "Unauthorized User Detection",
    "description": "Disable unauthorized local admin accounts (backdoor users)",
    "conditions": [
      {
        "field": "check_type",
        "operator": "in",
        "value": [
          "unauthorized_users",
          "backdoor_user"
        ]
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SEC-009",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "critical",
    "cooldown_seconds": 300,
    "max_retries": 1,
    "source": "builtin"
  },
  {
    "id": "L1-NLA-001",
    "name": "NLA Enforcement",
    "description": "Enable Network Level Authentication for RDP",
    "conditions": [
      {
        "field": "check_type",
        "operator": "in",
        "value": [
          "nla",
          "rdp_security"
        ]
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SEC-010",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-UAC-001",
    "name": "UAC Enforcement",
    "description": "Enable User Account Control settings",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "uac"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SEC-011",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 600,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-EVENTLOG-001",
    "name": "Event Log Protection",
    "description": "Protect Windows event logs and ensure proper retention",
    "conditions": [
      {
        "field": "check_type",
        "operator": "in",
        "value": [
          "event_log",
          "event_log_protection"
        ]
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SEC-012",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 600,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-CREDGUARD-001",
    "name": "Credential Guard / LSA Protection",
    "description": "Enable LSA Protection for credential security",
    "conditions": [
      {
        "field": "check_type",
        "operator": "in",
        "value": [
          "credential_guard",
          "lsa_protection"
        ]
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SEC-013",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "medium",
    "cooldown_seconds": 900,
    "max_retries": 1,
    "source": "builtin"
  },
  {
    "id": "L1-BITLOCKER-001",
    "name": "BitLocker Status Recovery",
    "description": "Resume BitLocker protection if suspended (Windows only)",
    "conditions": [
      {
        "field": "check_type",
        "operator": "in",
        "value": [
          "bitlocker",
          "bitlocker_status",
          "encryption"
        ]
      },
      {
        "field": "host_id",
        "operator": "regex",
        "value": "^[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+$"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SEC-005",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "critical",
    "cooldown_seconds": 900,
    "max_retries": 1,
    "source": "builtin"
  },
  {
    "id": "L1-PATCH-001",
    "name": "Windows Patch Compliance",
    "description": "Apply critical Windows security updates",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "patching"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-PATCH-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 3600,
    "max_retries": 1,
    "source": "builtin"
  },
  {
    "id": "L1-BACKUP-001",
    "name": "Backup Verification Alert",
    "description": "Escalate when backup is stale or failing",
    "conditions": [
      {
        "field": "check_type",
        "operator": "in",
        "value": [
          "backup",
          "backup_status",
          "windows_backup_status"
        ]
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "escalate"
    ],
    "action_params": {
      "reason": "Backup verification failed - manual review required"
    },
    "severity": "critical",
    "cooldown_seconds": 3600,
    "max_retries": 1,
    "source": "builtin"
  },
  {
    "id": "L1-LOGGING-001",
    "name": "Windows Event Logging",
    "description": "Configure Windows audit policy and event logging",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "logging"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-LOGGING-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 600,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-DNS-001",
    "name": "DNS Client Configuration Reset",
    "description": "Reset DNS client settings to proper DNS servers",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "dns_client"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-NET-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "medium",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-NETWORK-001",
    "name": "Network Adapter Reset",
    "description": "Reset network adapter if connectivity issues detected",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "network_adapter"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-NET-002",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-PROFILE-001",
    "name": "Network Profile Remediation",
    "description": "Fix network profile for proper firewall behavior",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "network_profile"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-NET-003",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "medium",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-DNSSVC-001",
    "name": "DNS Server Service Recovery",
    "description": "Restart DNS Server service if stopped",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "dns_service"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SVC-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "critical",
    "cooldown_seconds": 300,
    "max_retries": 3,
    "source": "builtin"
  },
  {
    "id": "L1-DHCPSVC-001",
    "name": "DHCP Server Service Recovery",
    "description": "Restart DHCP Server service if stopped",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "dhcp_service"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SVC-002",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 300,
    "max_retries": 3,
    "source": "builtin"
  },
  {
    "id": "L1-TIMESVC-001",
    "name": "Windows Time Service Recovery",
    "description": "Restart W32Time service for proper NTP sync",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "time_service"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SVC-004",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 300,
    "max_retries": 3,
    "source": "builtin"
  },
  {
    "id": "L1-AD-001",
    "name": "Active Directory Health Check",
    "description": "Check and fix AD replication and health issues",
    "conditions": [
      {
        "field": "check_type",
        "operator": "in",
        "value": [
          "ad_health",
          "ad_replication"
        ]
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-AD-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 600,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-ANTIVIRUS-001",
    "name": "Antivirus Health Check",
    "description": "Enable antivirus and update signatures",
    "conditions": [
      {
        "field": "check_type",
        "operator": "eq",
        "value": "antivirus"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-AV-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "critical",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-SVC-W32TIME-001",
    "name": "Windows Time Service Recovery",
    "description": "Restart W32Time service when stopped",
    "conditions": [
      {
        "field": "check_type",
        "operator": "in",
        "value": [
          "service_w32time",
          "windows_service_w32time"
        ]
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SVC-004",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 300,
    "max_retries": 3,
    "source": "builtin"
  },
  {
    "id": "L1-SVC-DNS-001",
    "name": "DNS Server Service Recovery",
    "description": "Restart DNS Server service when stopped",
    "conditions": [
      {
        "field": "check_type",
        "operator": "in",
        "value": [
          "service_dns",
          "windows_service_dns"
        ]
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SVC-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "critical",
    "cooldown_seconds": 300,
    "max_retries": 3,
    "source": "builtin"
  },
  {
    "id": "L1-SVC-SPOOLER-001",
    "name": "Print Spooler Service Recovery",
    "description": "Restart Print Spooler service when stopped",
    "conditions": [
      {
        "field": "check_type",
        "operator": "in",
        "value": [
          "service_spooler",
          "windows_service_spooler"
        ]
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_windows_runbook"
    ],
    "action_params": {
      "runbook_id": "RB-WIN-SVC-003",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "medium",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin"
  },
  {
    "id": "L1-LIN-SSH-001",
    "name": "Linux SSH Root Login Disabled",
    "description": "Disable SSH root login on Linux servers",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-SSH-001"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_linux_runbook"
    ],
    "action_params": {
      "runbook_id": "LIN-SSH-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-SSH-002",
    "name": "Linux SSH Password Auth Disabled",
    "description": "Disable SSH password authentication on Linux",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-SSH-002"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_linux_runbook"
    ],
    "action_params": {
      "runbook_id": "LIN-SSH-002",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-SSH-003",
    "name": "Linux SSH Max Auth Tries",
    "description": "Limit SSH authentication attempts on Linux",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-SSH-003"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_linux_runbook"
    ],
    "action_params": {
      "runbook_id": "LIN-SSH-003",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "medium",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-FW-001",
    "name": "Linux Firewall Active",
    "description": "Ensure firewall (ufw/firewalld) is active on Linux",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-FW-001"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_linux_runbook"
    ],
    "action_params": {
      "runbook_id": "LIN-FW-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "critical",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-SVC-001",
    "name": "Linux SSH Service Running",
    "description": "Ensure SSH daemon is running on Linux",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-SVC-001"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_linux_runbook"
    ],
    "action_params": {
      "runbook_id": "LIN-SVC-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "critical",
    "cooldown_seconds": 300,
    "max_retries": 3,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-SVC-002",
    "name": "Linux Audit Daemon Running",
    "description": "Ensure auditd is running on Linux for HIPAA compliance",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-SVC-002"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_linux_runbook"
    ],
    "action_params": {
      "runbook_id": "LIN-SVC-002",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-SVC-003",
    "name": "Linux Rsyslog Running",
    "description": "Ensure rsyslog is running on Linux",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-SVC-003"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_linux_runbook"
    ],
    "action_params": {
      "runbook_id": "LIN-SVC-003",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-SVC-004",
    "name": "Linux No Telnet Service",
    "description": "Ensure telnet service is disabled on Linux",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-SVC-004"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_linux_runbook"
    ],
    "action_params": {
      "runbook_id": "LIN-SVC-004",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "critical",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-AUDIT-001",
    "name": "Linux Audit Identity Files",
    "description": "Audit access to /etc/passwd and /etc/shadow",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-AUDIT-001"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_linux_runbook"
    ],
    "action_params": {
      "runbook_id": "LIN-AUDIT-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 600,
    "max_retries": 2,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-AUDIT-002",
    "name": "Linux Audit Auth Logs",
    "description": "Audit access to authentication logs",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-AUDIT-002"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_linux_runbook"
    ],
    "action_params": {
      "runbook_id": "LIN-AUDIT-002",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 600,
    "max_retries": 2,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-PERM-001",
    "name": "Linux Shadow File Permissions",
    "description": "Ensure /etc/shadow has correct permissions",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-PERM-001"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_linux_runbook"
    ],
    "action_params": {
      "runbook_id": "LIN-PERM-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "critical",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-PERM-002",
    "name": "Linux SSH Config Permissions",
    "description": "Ensure /etc/ssh/sshd_config has correct permissions",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-PERM-002"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_linux_runbook"
    ],
    "action_params": {
      "runbook_id": "LIN-PERM-002",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 300,
    "max_retries": 2,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-PERM-003",
    "name": "Linux No World-Writable Files",
    "description": "Remove world-writable files from /etc",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-PERM-003"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_linux_runbook"
    ],
    "action_params": {
      "runbook_id": "LIN-PERM-003",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 600,
    "max_retries": 2,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-NTP-001",
    "name": "Linux Time Synchronization",
    "description": "Configure NTP time synchronization on Linux",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-NTP-001"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_linux_runbook"
    ],
    "action_params": {
      "runbook_id": "LIN-NTP-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 600,
    "max_retries": 2,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-IR-001",
    "name": "Linux Incident Response Readiness",
    "description": "Ensure IR tools and logging are configured on Linux",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-IR-001"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "run_linux_runbook"
    ],
    "action_params": {
      "runbook_id": "LIN-IR-001",
      "phases": [
        "remediate",
        "verify"
      ]
    },
    "severity": "high",
    "cooldown_seconds": 900,
    "max_retries": 2,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-PATCH-001",
    "name": "Linux Security Updates (Escalate)",
    "description": "Escalate Linux patching - requires human review",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-PATCH-001"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "escalate"
    ],
    "action_params": {
      "reason": "Linux security updates require human review before application"
    },
    "severity": "high",
    "cooldown_seconds": 3600,
    "max_retries": 1,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-ACCT-001",
    "name": "Linux UID 0 Accounts (Escalate)",
    "description": "Escalate unauthorized UID 0 accounts - requires investigation",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-ACCT-001"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "escalate"
    ],
    "action_params": {
      "reason": "Unauthorized UID 0 account detected - requires security review"
    },
    "severity": "critical",
    "cooldown_seconds": 300,
    "max_retries": 1,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-MAC-001",
    "name": "Linux MAC/SELinux (Escalate)",
    "description": "Escalate MAC changes - can break applications",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-MAC-001"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "escalate"
    ],
    "action_params": {
      "reason": "SELinux/AppArmor changes require careful review to avoid breaking applications"
    },
    "severity": "high",
    "cooldown_seconds": 3600,
    "max_retries": 1,
    "source": "builtin",
    "priority": 5
  },
  {
    "id": "L1-LIN-INTEGRITY-001",
    "name": "Linux File Integrity (Escalate)",
    "description": "Escalate FIM setup - can be disruptive",
    "conditions": [
      {
        "field": "runbook_id",
        "operator": "eq",
        "value": "LIN-INTEGRITY-001"
      },
      {
        "field": "status",
        "operator": "in",
        "value": [
          "warning",
          "fail",
          "error"
        ]
      }
    ],
    "actions": [
      "escalate"
    ],
    "action_params": {
      "reason": "File integrity monitoring setup requires planned deployment"
    },
    "severity": "high",
    "cooldown_seconds": 3600,
    "max_retries": 1,
    "source": "builtin",
    "priority": 5
  }
]